# ООП 3 . Паттерн MVC. 

MVC или "Model View Controller" - это популярный паттерн связывания ООП классов между собой. 

- **Model** - Модель - отвечает за хранение, изменение данных 
- **View** - отвечает за визуализацию данных 
- **Controller** - отвечает за связывание между собой Модели и Контроллера

Подобная схема позволяет вам изменять легко изменять логику хранения данных,  визуализации данных. Для внесения изменений вам будет достаточно изменить какой-то один класс. 

Такой паттерн улучшает надежность системы. Дает возможность легко изменять логику программы, масштабировать под новые задачи. 

Похожий принцип используется в вебе. Веб-фреймворки Django, Flask внутри себя похожим образом разделяют логику обработки данных. 

![фвыа](http://images.na4u.ru/static/oop3/1.jpg)
### Приложение для работы с заметками

Рассмотрим паттерн MVC на примере приложения для работы с заметками. 

Пользователь выбирает в меню:
- добавить заметку
- посмотреть заметки
#### Контроллер  (Controller)
Может состоять из двух соответствующих методов
- добавить заметку
	- спрашивает текст заметки
	- сохраняет в базу
- посмотреть заметки
	- идет в базу за всеми заметками
	- визуализирует их в консоль


#### Модель  (Model)
Может состоять из двух методов
- сохранить данные в json  в файл
- прочитать данные из json файла

Это лишь один из вариантов. Можно сделать класс более широким, обозначив там конкретные методы для добавления и получения заметок. 
### Вью (View)

Вью в нашем случае может иметь два метода: 
- Вывод сообщения в консоль
- Вывод списка заметок в консоль

## Итоговый код

```python
import json
import os
from abc import ABC, abstractmethod
from rich.console import Console
from rich.table import Table

# ===== Model =====
class NotesModel:
    def __init__(self, filename="notes.json"):
        self.filename = filename
        self.notes = self.load()

    def add_note(self, title, content):
        self.notes.append({"title": title, "content": content})
        self.save()

    def get_notes(self):
        return self.notes

    def save(self):
        with open(self.filename, "w", encoding="utf-8") as f:
            json.dump(self.notes, f, ensure_ascii=False, indent=2)

    def load(self):
        if not os.path.exists(self.filename):
            return []
        with open(self.filename, "r", encoding="utf-8") as f:
            return json.load(f)


class BasicView():
    def show_notes(self, notes):
        if not notes:
            print("Нет заметок.")
        for i, note in enumerate(notes, 1):
            print(f"{i}. {note['title']}\n   {note['content']}")

    def show_message(self, message):
        print(message)


class RichView():
    def __init__(self):
        self.console = Console()

    def show_notes(self, notes):
        if not notes:
            self.console.print("[bold red]Нет заметок[/bold red]")
            return
        table = Table(title="Заметки")
        table.add_column("№", style="cyan")
        table.add_column("Заголовок", style="green")
        table.add_column("Содержание", style="yellow")
        for i, note in enumerate(notes, 1):
            table.add_row(str(i), note["title"], note["content"])
        self.console.print(table)

    def show_message(self, message):
        self.console.print(f"[bold blue]{message}[/bold blue]")

# ===== Controller =====
class NotesController:
    def __init__(self, model, view):
        self.model = model
        self.view = view

    def add_note(self):
        title = input("Заголовок: ")
        content = input("Содержание: ")
        self.model.add_note(title, content)
        self.view.show_message("Заметка добавлена!")

    def show_notes(self):
        self.view.show_notes(self.model.get_notes())



model = NotesModel()
view = RichView() 
controller = NotesController(model, view)


while True:
    print("\nМеню:")
    print("1. Добавить заметку")
    print("2. Показать заметки")
    print("3. Выйти")
    choice = input("Выберите действие: ").strip()
    if choice == "1":
        controller.add_note()
    elif choice == "2":
        controller.show_notes()
    elif choice == "3":
        break
    else:
        controller.view.show_message("Неверный выбор!")
```


Заметьте, что в начале мы создаем экземпляры классов для Модели и Визуализатора. В дальнейшем их можно будет подменить другими подобными. 

Сейчас в качестве хранения данных используется json файл. 
В качестве визуализатора используется класс с библиотекой RiсchView, которая более красиво выводит данные. 

![фвыа](http://images.na4u.ru/static/oop3/1.png)

